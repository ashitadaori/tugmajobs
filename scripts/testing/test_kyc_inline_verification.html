<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KYC Inline Verification Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <meta name="csrf-token" content="test-token-12345">
    <meta name="user-id" content="3">
</head>
<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h4 class="mb-0">
                            <i class="fas fa-id-card me-2"></i>
                            KYC Inline Verification Test
                        </h4>
                    </div>
                    <div class="card-body">
                        <div class="alert alert-info">
                            <h5>Test Information:</h5>
                            <p><strong>CSRF Token:</strong> <span id="csrf-display">Loading...</span></p>
                            <p><strong>User ID:</strong> <span id="user-id-display">Loading...</span></p>
                            <p><strong>Current URL:</strong> <span id="url-display">Loading...</span></p>
                        </div>
                        
                        <div class="text-center">
                            <button type="button" class="btn btn-primary btn-lg" onclick="startInlineVerification()">
                                <i class="fas fa-play me-2"></i>
                                Start KYC Verification
                            </button>
                        </div>
                        
                        <div class="mt-4">
                            <h5>Console Output:</h5>
                            <div id="console-output" class="border p-3" style="height: 300px; overflow-y: auto; background-color: #f8f9fa; font-family: monospace; font-size: 12px;">
                                <!-- Console output will appear here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/kyc-inline-verification.js"></script>
    
    <script>
        // Override console.log to display in the page
        const originalConsoleLog = console.log;
        const originalConsoleError = console.error;
        const originalConsoleWarn = console.warn;
        
        function addToConsoleOutput(message, type = 'log') {
            const output = document.getElementById('console-output');
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? 'text-danger' : type === 'warn' ? 'text-warning' : 'text-dark';
            
            const div = document.createElement('div');
            div.className = color;
            div.innerHTML = `[${timestamp}] ${type.toUpperCase()}: ${JSON.stringify(message, null, 2)}`;
            
            output.appendChild(div);
            output.scrollTop = output.scrollHeight;
        }
        
        console.log = function(...args) {
            originalConsoleLog.apply(console, args);
            addToConsoleOutput(args.length === 1 ? args[0] : args, 'log');
        };
        
        console.error = function(...args) {
            originalConsoleError.apply(console, args);
            addToConsoleOutput(args.length === 1 ? args[0] : args, 'error');
        };
        
        console.warn = function(...args) {
            originalConsoleWarn.apply(console, args);
            addToConsoleOutput(args.length === 1 ? args[0] : args, 'warn');
        };
        
        // Update display information
        document.addEventListener('DOMContentLoaded', function() {
            const csrfToken = document.querySelector('meta[name="csrf-token"]');
            const userId = document.querySelector('meta[name="user-id"]');
            
            document.getElementById('csrf-display').textContent = csrfToken ? csrfToken.getAttribute('content') : 'Not found';
            document.getElementById('user-id-display').textContent = userId ? userId.getAttribute('content') : 'Not found';
            document.getElementById('url-display').textContent = window.location.href;
            
            console.log('Test page loaded successfully');
            console.log('CSRF Token:', csrfToken ? csrfToken.getAttribute('content') : 'Not found');
            console.log('User ID:', userId ? userId.getAttribute('content') : 'Not found');
        });
    </script>
</body>
</html>